# ComfyStream UV Cheat Sheet

## Quick Start

```bash
# Install uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# Install comfystream
uv pip install -e .

# Build UI
uv run build
```

## Common Commands

### Installation

```bash
# Install from GitHub
uv pip install git+https://github.com/livepeer/comfystream.git

# Install locally (development)
uv pip install -e .

# Install with dev dependencies
uv pip install -e ".[dev]"
```

### Building

```bash
# Build UI
uv run build

# Or manually
cd ui && npm install && npm run build
```

### Dependency Management

```bash
# Sync requirements.txt → pyproject.toml
python sync_requirements.py --from-requirements

# Sync pyproject.toml → requirements.txt
python sync_requirements.py --from-pyproject
```

### Code Quality

```bash
# Format code
ruff format .

# Lint code
ruff check .

# Fix linting issues
ruff check --fix .
```

### Testing

```bash
# Install test dependencies
uv pip install -e ".[dev]"

# Run tests
pytest
```

### Legacy Commands (still work)

```bash
# Traditional pip
pip install -r requirements.txt
pip install -e .

# Manual build
cd ui
npm install
npm run build
```

## File Structure

```
comfystream/
├── build.py                 # Build script (uv run build)
├── sync_requirements.py     # Dependency sync tool
├── pyproject.toml          # Project metadata & dependencies
├── requirements.txt        # Legacy requirements file
├── UV_MIGRATION.md         # Migration guide
├── CHANGES.md             # Change summary
└── .uv-cheatsheet.md      # This file
```

## Environment Variables

```bash
# ComfyUI workspace
export COMFY_UI_WORKSPACE=/path/to/ComfyUI

# Twilio (for TURN servers)
export TWILIO_ACCOUNT_SID=...
export TWILIO_AUTH_TOKEN=...
```

## Troubleshooting

### uv not found
```bash
# Install uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# Add to PATH
export PATH="$HOME/.cargo/bin:$PATH"
```

### Git dependencies fail
```bash
# Ensure git is configured
git config --global credential.helper store
```

### Build fails
```bash
# Ensure Node.js is installed
node --version  # Should be >= 18.x

# Clean and rebuild
rm -rf ui/node_modules ui/.next
uv run build
```

## Performance

| Command | Time (pip) | Time (uv) | Speedup |
|---------|------------|-----------|---------|
| Install all deps | ~120s | ~12s | 10x |
| Install single pkg | ~5s | ~0.5s | 10x |
| Resolve deps | ~30s | ~3s | 10x |

## More Info

- Full migration guide: `UV_MIGRATION.md`
- Change summary: `CHANGES.md`
- UV docs: https://docs.astral.sh/uv/
- Project docs: https://docs.comfystream.org/

